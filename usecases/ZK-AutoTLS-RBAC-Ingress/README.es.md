# Autogenerated Cert, RBAC Authorization and Static Host Based Ingress controller External Access

[![en](https://img.shields.io/badge/lang-en-red.svg)](https://github.com/ogomezso/cfk-runbooks/blob/main/usecases/ZK-AutoTLS-RBAC-Ingress/README.md)
[![es](https://img.shields.io/badge/lang-es-yellow.svg)](https://github.com/ogomezso/cfk-runbooks/blob/main/ussescases/ZK-AutoTLS-RBAC-Ingress/README.es.md)

En este caso de uso implementaremos:

- Comunicación Interna (entre componentes Confluent) y externa (entre clientes no confluent externos al cluster CFK) securizada por TLS simple con certificados autofirmados.
- Comunicación Externa a través del Ingress Controller
- Autorización RBAC sin backend (lista de usuarios)
- Autenticación Inter-broker (REPLICATION Listener) usara SASL_SSL Plain
- Componentes Confluent (schema registry, connect, etc) usaran autenticación oauth bearer (MDS).
- Autenticación Interna (INTERNAL Listener) SASL_SSL PLAIN (for internal K8s clients such a microservices)
- External authentication (EXTERNAL Listener) SASL_SSL PLAIN (for non K8s cluster clients)

## Certificados

Como primer paso generaremos los certificados necesarios para nuestra instalación.

Más información en la sección [Certs](https://github.com/ogomezso/cfk-runbooks/blob/main/usecases/ZK-AutoTLS-RBAC-Ingress/certs/README.es.md).

## Secretos

Preparación de los secretos que necesitaremos para **toda** la instalación

Más información en la sección  [Secrets](https://github.com/ogomezso/cfk-runbooks/blob/main/usecases/ZK-AutoTLS-RBAC-Ingress/secrets/README.es.md).

## Ingress

Para resolver el acceso externo al cluster necesitaremos levantar una solución de

En la sección [Ingress Controller](https://github.com/ogomezso/cfk-runbooks/blob/main/ingress/README.md) encontrarás información sobre como levantar algunas de nuestras favoritas.

## Componentes Confluent

Para mayor legibilidad y facilidad de documentación separaremos los recursos en diferentes ficheros.

### 1. Zookeeper

Usaremos certificados autofirmados y autenticación tipo digest (basada en configuración tipo JaaS)

Para aplicar el recurso `zookeeper` ejecutaremos el siguiente comando desde el root del proyecto:

```bash
kubectl apply -f usecases/ZK-AutoTLS-RBAC-Ingress/2.zookeeper
```

### 2. Brokers

### 3. Schema Registry

### 4. Kafka Connect

### 5. KSQLDB

### 6. Rest Proxy

### 7. Control Center
